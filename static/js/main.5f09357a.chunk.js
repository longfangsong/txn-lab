(this["webpackJsonptxn-lab"]=this["webpackJsonptxn-lab"]||[]).push([[0],{155:function(t,e,n){},156:function(t,e,n){},157:function(t,e,n){},158:function(t,e,n){},271:function(t,e,n){},272:function(t,e,n){"use strict";n.r(e);var i=n(8),a=n(0),s=n.n(a),r=n(30),c=n.n(r),o=(n(155),n(156),n(54)),u=n(32);n(157);function m(t){return void 0===t.atomics}var l=n(106),h=(n(158),n(275)),y=n(277);function d(t){var e=t.event,n=[{title:"Name",dataIndex:"name",key:"name",render:function(t){return Object(i.jsx)("b",{children:t})}},{title:"value",dataIndex:"value",key:"value"}];return Object(i.jsx)(h.a,{columns:n,dataSource:e.displayFields.map((function(t){return Object(l.a)(Object(l.a)({},t),{},{key:t.name})})),pagination:{hideOnSinglePage:!0},showHeader:!1,bordered:!0,size:"small"})}function p(t){var e=t.event,n=t.onMouseEnter,a=t.onMouseLeave;return Object(i.jsx)(y.a,{title:e.typename,content:d({event:e}),children:Object(i.jsx)("div",{className:"event",style:{left:"".concat(e.timestamp,"%")},onMouseEnter:n,onMouseLeave:a})})}n(271);function v(t){var e=t.events,n=t.onMouseEnter,a=t.onMouseLeave;return Object(i.jsxs)(i.Fragment,{children:[e.atomics.map((function(t){return Object(i.jsx)(p,{event:t,onMouseEnter:n,onMouseLeave:a},"atom-"+t.timestamp)})),e.atomics.map((function(t,s){if(0===s)return Object(i.jsx)(i.Fragment,{});var r=e.atomics[s-1];return Object(i.jsx)("div",{className:"event-group-link",style:{left:"calc(".concat(r.timestamp,"% + 9px)"),width:"calc(".concat(t.timestamp-r.timestamp,"% - 8px)")},onMouseEnter:n,onMouseLeave:a},"line-"+r.timestamp)}))]})}var f=n(46),j=n(276);function k(t){var e=t.lock,n=[{title:"Name",dataIndex:"name",key:"name",render:function(t){return Object(i.jsx)("b",{children:t})}},{title:"value",dataIndex:"value",key:"value"}];return Object(i.jsx)(h.a,{columns:n,dataSource:[{name:"By Transaction",value:e.by_transaction,key:"by_transaction"},{name:"Primary Key",value:e.primary,key:"primary"}],pagination:{hideOnSinglePage:!0},showHeader:!1,bordered:!0,size:"small"})}function b(t){var e=t.snapshot,n=[{title:"Key",dataIndex:"key",key:"key"},{title:"data",dataIndex:"data",key:"data"},{title:"lock",dataIndex:"lock",key:"lock",render:function(t){return t?Object(i.jsx)(y.a,{content:Object(i.jsx)(k,{lock:t}),title:"Lock Detail",children:Object(i.jsx)(j.a,{style:{color:"#2fb82f"}})}):Object(i.jsx)(i.Fragment,{})}},{title:"write_record",dataIndex:"write_record",key:"write_record"}],a=Array.from(e).map((function(t){var e=Object(u.a)(t,2),n=e[0],i=Object(u.a)(e[1],3),a=i[0],s=i[1],r=i[2];return{key:n,data:a,lock:s,write_record:null===r||void 0===r?void 0:r.by_transaction}}));return Object(i.jsx)(h.a,{columns:n,dataSource:a,pagination:{hideOnSinglePage:!0},showHeader:!0,bordered:!0,size:"small"})}var O=n(59),_=n(24),w=n(25);function x(t,e){if(void 0!==t)return f.maxBy(Array.from(t).filter((function(t){var n=Object(u.a)(t,2),i=n[0];n[1];return i<=e})),(function(t){var e=Object(u.a)(t,2),n=e[0];e[1];return n}))}var g=function(){function t(){Object(_.a)(this,t),this.data=void 0,this.lock=void 0,this.write=void 0,this.data=new Map,this.lock=new Map,this.write=new Map}return Object(w.a)(t,[{key:"setData",value:function(t,e,n){this.data.has(e)||this.data.set(e,new Map),this.data.get(e).set(t,n)}},{key:"setLock",value:function(t,e,n){this.lock.has(e)||this.lock.set(e,new Map),this.lock.get(e).set(t,n)}},{key:"setWrite",value:function(t,e,n){this.write.has(e)||this.write.set(e,new Map),this.write.get(e).set(t,n)}},{key:"snapshot",value:function(t){var e,n,i=new Map,a=Array.from(this.data.keys());(e=a).push.apply(e,Object(O.a)(Array.from(this.lock.keys()))),(n=a).push.apply(n,Object(O.a)(Array.from(this.write.keys()))),a=a.sort(),a=f.sortedUniq(a);var s,r=Object(o.a)(a);try{for(r.s();!(s=r.n()).done;){var c=s.value,u=x(this.data.get(c),t)||[0,""],m=x(this.lock.get(c),t)||[0,null],l=x(this.write.get(c),t)||[0,null];i.set(c,[u[1],m[1],l[1]])}}catch(h){r.e(h)}finally{r.f()}return i}}]),t}();function S(t){var e=t.transaction,n=t.style;return Object(i.jsxs)("div",{style:n,children:[Object(i.jsx)("div",{className:"event-line-top",style:{left:"".concat(e[0].timestamp,"%"),width:"".concat(e[e.length-1].timestamp-e[0].timestamp,"%")}}),e.map((function(t){return Object(i.jsx)("div",{className:"event-line",style:{left:"".concat(t.timestamp,"%")}},"event-line-"+t.timestamp)}))]})}function M(t){var e=t.session,n=t.style,s=Object(a.useState)(null),r=Object(u.a)(s,2),c=r[0],l=r[1],h=Object(a.useState)(0),y=Object(u.a)(h,2),d=y[0],j=y[1],k=Object(a.useRef)(null),O=function(){var t,n=new g,i=Object(o.a)(e.events);try{for(i.s();!(t=i.n()).done;){var a=t.value;if(m(a))a.timestamp<=d&&a.applyOnStore(n);else{var s,r=Object(o.a)(a.atomics);try{for(r.s();!(s=r.n()).done;){var c=s.value;c.timestamp<=d&&c.applyOnStore(n)}}catch(u){r.e(u)}finally{r.f()}}}}catch(u){i.e(u)}finally{i.f()}return n}(),_=f.throttle((function(t){var e=k.current,n=t.clientX-e.offsetLeft;j(n/e.offsetWidth*100)}),100,{trailing:!0});return Object(i.jsxs)("div",{className:"timeline-wrapper",style:n,children:[Object(i.jsx)("div",{className:"transaction-bar",children:Array.from(e.transactions).map((function(t){return Object(i.jsx)(S,{transaction:t,style:{opacity:t[0].transaction_id===c?"100%":"5%"}},t[0].transaction_id)}))}),Object(i.jsxs)("div",{className:"timeline",ref:k,onMouseMove:_,children:[Object(i.jsx)("div",{className:"rails"}),e.events.map((function(t){return m(t)?Object(i.jsx)(p,{event:t,onMouseEnter:function(){return l(t.transaction_id)},onMouseLeave:function(){return l(null)}},"atomic-ev-"+t.timestamp):Object(i.jsx)(v,{events:t,onMouseEnter:function(){return l(t.transaction_id)},onMouseLeave:function(){return l(null)}},"group-ev-"+t.timestamp)})),Object(i.jsx)("div",{className:"cursor",style:{left:"".concat(d,"%"),zIndex:-1}})]}),Object(i.jsx)(b,{snapshot:O.snapshot(d)})]})}var P=function(){function t(e){Object(_.a)(this,t),this.transaction_id=e,this.typename="StartTxnRequest"}return Object(w.a)(t,[{key:"applyOnStore",value:function(t){}},{key:"timestamp",get:function(){return this.transaction_id}},{key:"displayFields",get:function(){return[{name:"timestamp",value:this.timestamp.toString()}]}}]),t}(),L=function(){function t(e,n,i,a){Object(_.a)(this,t),this.timestamp=e,this.transaction_id=n,this.key=i,this.value=a,this.typename="PrewritePrimary"}return Object(w.a)(t,[{key:"applyOnStore",value:function(t){t.setData(this.transaction_id,this.key,this.value),t.setLock(this.transaction_id,this.key,{by_transaction:this.transaction_id,primary:this.key})}},{key:"displayFields",get:function(){return[{name:"key",value:this.key},{name:"value",value:this.value}]}}]),t}(),F=function(){function t(e,n,i,a,s){Object(_.a)(this,t),this.timestamp=e,this.transaction_id=n,this.key=i,this.value=a,this.primary=s,this.typename="PrewriteSecondary"}return Object(w.a)(t,[{key:"applyOnStore",value:function(t){t.setData(this.transaction_id,this.key,this.value),t.setLock(this.transaction_id,this.key,{by_transaction:this.transaction_id,primary:this.primary})}},{key:"displayFields",get:function(){return[{name:"key",value:this.key},{name:"value",value:this.value}]}}]),t}(),N=function(){function t(e,n,i,a,s,r){Object(_.a)(this,t),this.transaction_id=e,this.mutations=n,this.primary_lock_on_key=i,this.timestamp=a,this.typename="Prewrite",this.prewritePrimary=void 0,this.prewriteSecondaries=void 0;var c=a;void 0!==s?this.prewritePrimary=new L(s,e,i,n.find((function(t){return t.key===i})).value):(c++,this.prewritePrimary=new L(c,e,i,n.find((function(t){return t.key===i})).value)),void 0!==r?this.prewriteSecondaries=f.zip(n,r).map((function(t){var n=Object(u.a)(t,2),a=n[0],s=n[1];return new F(s,e,a.key,a.value,i)})):(c++,this.prewriteSecondaries=n.filter((function(t){return t.key!==i})).map((function(t,n){return new F(c+n,e,t.key,t.value,i)})))}return Object(w.a)(t,[{key:"applyOnStore",value:function(t){}},{key:"atomics",get:function(){return[this,this.prewritePrimary].concat(Object(O.a)(this.prewriteSecondaries))}},{key:"displayFields",get:function(){return[{name:"primary",value:this.primary_lock_on_key}]}}]),t}(),I=function t(e,n){Object(_.a)(this,t),this.key=e,this.value=n},A=function(){function t(e,n,i,a){Object(_.a)(this,t),this.transaction_id=e,this.commit_at_timestamp=n,this.timestamp=i,this.key=a,this.typename="CommitPrimary"}return Object(w.a)(t,[{key:"applyOnStore",value:function(t){t.setWrite(this.commit_at_timestamp,this.key,{by_transaction:this.transaction_id}),t.setLock(this.commit_at_timestamp,this.key,null)}},{key:"displayFields",get:function(){return[{name:"key",value:this.key},{name:"commit_ts",value:this.commit_at_timestamp.toString()}]}}]),t}(),E=function(){function t(e,n,i,a){Object(_.a)(this,t),this.transaction_id=e,this.commit_at_timestamp=n,this.timestamp=i,this.key=a,this.typename="CommitSecondary"}return Object(w.a)(t,[{key:"applyOnStore",value:function(t){t.setWrite(this.commit_at_timestamp,this.key,{by_transaction:this.transaction_id}),t.setLock(this.commit_at_timestamp,this.key,null)}},{key:"displayFields",get:function(){return[{name:"key",value:this.key},{name:"commit_ts",value:this.commit_at_timestamp.toString()}]}}]),t}(),z=function(){function t(e,n,i,a,s,r){Object(_.a)(this,t),this.transaction_id=e,this.keys=n,this.primary_lock_on_key=i,this.timestamp=a,this.typename="Commit",this.commitPrimary=void 0,this.commitSecondaries=void 0;var c=a;void 0!==s?this.commitPrimary=new A(e,a,s,i):(c++,this.commitPrimary=new A(e,a,c,i)),void 0!==r?this.commitSecondaries=f.zip(n,r).map((function(t){var n=Object(u.a)(t,2),i=n[0],s=n[1];return new E(e,s,a,i)})):(c++,this.commitSecondaries=n.filter((function(t){return t!==i})).map((function(t,n){return new E(e,a,c+n,t)}))),this.commitSecondaries.sort((function(t,e){return t.timestamp-e.timestamp}))}return Object(w.a)(t,[{key:"applyOnStore",value:function(t){}},{key:"atomics",get:function(){return[this,this.commitPrimary].concat(Object(O.a)(this.commitSecondaries))}},{key:"displayFields",get:function(){return[{name:"primary key",value:this.primary_lock_on_key}]}}]),t}(),C=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];Object(_.a)(this,t),this.events=e}return Object(w.a)(t,[{key:"transactions",get:function(){var t,e=new Map,n=Object(o.a)(this.events);try{for(n.s();!(t=n.n()).done;){var i=t.value;e.has(i.transaction_id)?e.get(i.transaction_id).push(i):e.set(i.transaction_id,[i])}}catch(a){n.e(a)}finally{n.f()}return Array.from(e.values())}}]),t}(),D=function(){var t=new C;return t.events.push(new P(10)),t.events.push(new N(10,[new I("a","val1"),new I("b","val2")],"a",15)),t.events.push(new N(21,[new I("c","val3"),new I("d","val4")],"c",20)),t.events.push(new z(10,["a","b"],"a",50)),Object(i.jsx)("div",{className:"App",children:Object(i.jsx)(M,{session:t,style:{margin:"10px",padding:"10px"}})})},B=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,278)).then((function(e){var n=e.getCLS,i=e.getFID,a=e.getFCP,s=e.getLCP,r=e.getTTFB;n(t),i(t),a(t),s(t),r(t)}))};c.a.render(Object(i.jsx)(s.a.StrictMode,{children:Object(i.jsx)(D,{})}),document.getElementById("root")),B()}},[[272,1,2]]]);
//# sourceMappingURL=main.5f09357a.chunk.js.map