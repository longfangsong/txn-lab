{"version":3,"sources":["model/atomicEvent.ts","component/AtomicEventView/AtomicEventView.tsx","component/GroupEventView/GroupEventView.tsx","component/KeyValueDetailView/KeyValueDetailView.tsx","model/store.ts","component/Timeline/Timeline.tsx","model/event/startTxn.ts","model/event/prewrite/prewrite_primary.ts","model/event/prewrite/prewrite_secondary.ts","model/event/prewrite/prewrite.ts","model/mutation.ts","model/event/commit/commit_primary.ts","model/event/commit/commit_secondary.ts","model/event/commit/commit.ts","model/session.ts","App.tsx","reportWebVitals.ts","index.tsx"],"names":["isAtomic","event","undefined","atomics","EventDetail","columns","title","dataIndex","key","render","text","dataSource","displayFields","map","it","name","pagination","hideOnSinglePage","showHeader","bordered","size","AtomicEventView","onMouseEnter","onMouseLeave","typename","content","className","style","left","timestamp","GroupEventView","events","endAt","index","startAt","width","KeyValueDetail","snapshot","data","Array","from","lock","write_record","primary","by_transaction","atTimestamp","m","_","filter","ts","Store","write","this","Map","value","has","set","get","result","keys","push","sort","TransactionLine","transaction","length","request","Timeline","session","useState","txnSelected","setTxnSelected","currentViewingTime","setCurrentViewingTime","element","useRef","store","applyOnStore","sub","handleMouseMove","e","elem","current","offset","clientX","offsetLeft","offsetWidth","transactions","opacity","transaction_id","ref","onMouseMove","zIndex","StartTxnRequest","toString","PrewritePrimary","setData","setLock","PrewriteSecondary","Prewrite","mutations","primary_lock_on_key","prewritePrimaryTimestamp","prewriteSecondariesTimestamps","prewritePrimary","prewriteSecondaries","maxAllocatedTimestamp","find","mutation","prewriteSecondaryTimestamp","Put","CommitPrimary","commit_at_timestamp","setWrite","CommitSecondary","Commit","commitPrimaryTimestamp","commitSecondariesTimestamps","commitPrimary","commitSecondaries","a","b","Session","values","App","margin","padding","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.4f97cdb0.chunk.js","sourcesContent":["import {Store} from \"./store\";\n\nexport interface AtomicEvent {\n    readonly typename: string,\n    readonly timestamp: number,\n    readonly transaction_id: number\n\n    // todo: figure out conflict\n    applyOnStore(store: Store): void;\n\n    readonly displayFields: Array<{ name: string, value: string }>\n}\n\nexport interface GroupEvent {\n    readonly atomics: Array<AtomicEvent>\n    readonly timestamp: number,\n    readonly transaction_id: number,\n}\n\nexport function isAtomic(event: GroupEvent | AtomicEvent): event is AtomicEvent {\n    return (event as GroupEvent).atomics === undefined;\n}","import \"./AtomicEventView.css\";\nimport {Popover, Table} from \"antd\";\nimport {AtomicEvent} from \"../../model/atomicEvent\";\nimport {MouseEventHandler} from \"react\";\n\nfunction EventDetail({event}: { event: AtomicEvent }) {\n    const columns = [{\n        title: 'Name',\n        dataIndex: 'name',\n        key: 'name',\n        render: (text: string) => <b>{text}</b>,\n    }, {\n        title: 'value',\n        dataIndex: 'value',\n        key: 'value',\n    }];\n    return (<Table\n        columns={columns}\n        dataSource={event.displayFields.map(it => ({...it, key: it.name}))}\n        pagination={{hideOnSinglePage: true}}\n        showHeader={false}\n        bordered={true}\n        size={\"small\"}\n    />)\n}\n\nexport function AtomicEventView({\n                                    event,\n                                    onMouseEnter,\n                                    onMouseLeave\n                                }: { event: AtomicEvent, onMouseEnter: MouseEventHandler<HTMLDivElement>, onMouseLeave: MouseEventHandler<HTMLDivElement> }) {\n    return (\n        <Popover title={event.typename} content={EventDetail({event})}>\n            <div className={\"event\"} style={{left: `${event.timestamp}%`}}\n                 onMouseEnter={onMouseEnter}\n                 onMouseLeave={onMouseLeave}\n            />\n        </Popover>\n    )\n}","import \"./GroupEventView.css\";\nimport {GroupEvent} from \"../../model/atomicEvent\";\nimport {AtomicEventView} from \"../AtomicEventView/AtomicEventView\";\nimport {MouseEventHandler} from \"react\";\n\nexport function GroupEventView({\n                                   events,\n                                   onMouseEnter,\n                                   onMouseLeave\n                               }: { events: GroupEvent, onMouseEnter: MouseEventHandler<HTMLDivElement>, onMouseLeave: MouseEventHandler<HTMLDivElement> }) {\n    return (\n        <>\n            {events.atomics.map((event) => <AtomicEventView event={event}\n                                                            key={\"atom-\" + event.timestamp}\n                                                            onMouseEnter={onMouseEnter}\n                                                            onMouseLeave={onMouseLeave}/>\n            )}\n            {events.atomics.map((endAt, index) => {\n                if (index === 0) return <></>;\n                const startAt = events.atomics[index - 1];\n                return <div className={\"event-group-link\"}\n                            key={\"line-\" + startAt.timestamp}\n                            style={{\n                                left: `calc(${startAt.timestamp}% + 9px)`,\n                                width: `calc(${endAt.timestamp - startAt.timestamp}% - 8px)`\n                            }}\n                            onMouseEnter={onMouseEnter}\n                            onMouseLeave={onMouseLeave}\n                />\n            })}\n        </>\n    )\n}","import {Table} from \"antd\";\nimport {SnapShot} from \"../../model/store\";\n\nexport function KeyValueDetail({snapshot}: { snapshot: SnapShot }) {\n    const columns = [{\n        title: 'Key',\n        dataIndex: 'key',\n        key: 'key',\n    }, {\n        title: 'data',\n        dataIndex: 'data',\n        key: 'data',\n    }, {\n        title: 'lock',\n        dataIndex: 'lock',\n        key: 'lock',\n    }, {\n        title: 'write_record',\n        dataIndex: 'write_record',\n        key: 'write_record',\n    }];\n    const data = Array.from(snapshot)\n        .map(([key, [data, lock, write_record]]) => {\n            return {key: key, data: data, lock: lock?.primary, write_record: write_record?.by_transaction}\n        });\n    return <Table\n        columns={columns}\n        dataSource={data}\n        pagination={{hideOnSinglePage: true}}\n        showHeader={true}\n        bordered={true}\n        size={\"small\"}\n    />\n}","import {Lock} from \"./lock\";\nimport {WriteRecord} from \"./writeRecord\";\nimport * as _ from \"lodash\";\n\nexport function latest<T>(m: Map<number, T>): [number, T] | undefined {\n    return _.maxBy(Array.from(m), ([ts, _]) => ts)\n}\n\nexport function atTimestamp<T>(m: Map<number, T> | undefined, timestamp: number): [number, T] | undefined {\n    if (m === undefined) {\n        return undefined;\n    }\n    return _.maxBy(Array.from(m).filter(([ts, _]) => ts <= timestamp), ([ts, _]) => ts)\n}\n\nexport function afterTimestamp<T>(m: Map<number, T>, timestamp: number): Map<number, T> {\n    return new Map(Array.from(m).filter(([ts, _]) => ts > timestamp))\n}\n\nexport function allNotNull<T>(m: Map<number, T | null>): Array<[number, T]> {\n    return Array.from(m).filter(([_, item]) => item !== null) as Array<[number, T]>;\n}\n\nexport type SnapShot = Map<string, [string, Lock | null, WriteRecord | null]>;\nexport class Store {\n    constructor() {\n        this.data = new Map();\n        this.lock = new Map();\n        this.write = new Map();\n    }\n\n    // key -> timestamp -> value\n    public data: Map<string, Map<number, string>>;\n    public lock: Map<string, Map<number, Lock | null>>;\n    public write: Map<string, Map<number, WriteRecord | null>>;\n\n    public setData(timestamp: number, key: string, value: string) {\n        if (!this.data.has(key)) {\n            this.data.set(key, new Map());\n        }\n        this.data.get(key)!.set(timestamp, value)\n    }\n\n    public setLock(timestamp: number, key: string, value: Lock | null) {\n        if (!this.lock.has(key)) {\n            this.lock.set(key, new Map());\n        }\n        this.lock.get(key)!.set(timestamp, value)\n    }\n\n    public setWrite(timestamp: number, key: string, value: WriteRecord | null) {\n        if (!this.write.has(key)) {\n            this.write.set(key, new Map());\n        }\n        this.write.get(key)!.set(timestamp, value)\n    }\n\n    public snapshot(timestamp: number): SnapShot {\n        let result = new Map();\n        let keys = Array.from(this.data.keys());\n        keys.push(...Array.from(this.lock.keys()));\n        keys.push(...Array.from(this.write.keys()));\n        keys = keys.sort();\n        keys = _.sortedUniq(keys);\n        for (const key of keys) {\n            let dataItem = this.data.get(key);\n            const value = atTimestamp(dataItem, timestamp) || [0, \"\"];\n            let lockItem = this.lock.get(key);\n            const lock = atTimestamp(lockItem, timestamp) || [0, null];\n            let writeItem = this.write.get(key);\n            const write = atTimestamp(writeItem, timestamp) || [0, null];\n            result.set(key, [value[1], lock[1], write[1]]);\n        }\n        return result;\n    }\n}","import \"./Timeline.css\"\nimport {AtomicEvent, GroupEvent, isAtomic} from \"../../model/atomicEvent\";\nimport {AtomicEventView} from \"../AtomicEventView/AtomicEventView\";\nimport {GroupEventView} from \"../GroupEventView/GroupEventView\";\nimport {Session} from \"../../model/session\";\nimport CSS from 'csstype';\nimport {useRef, useState} from \"react\";\nimport * as _ from \"lodash\";\nimport {KeyValueDetail} from \"../KeyValueDetailView/KeyValueDetailView\";\nimport {Store} from \"../../model/store\";\n\nfunction TransactionLine({\n                             transaction,\n                             style\n                         }: { transaction: Array<AtomicEvent | GroupEvent>, style: CSS.Properties }) {\n    return <div style={style}>\n        <div className={\"event-line-top\"} style={{\n            left: `${transaction[0].timestamp}%`,\n            width: `${transaction[transaction.length - 1].timestamp - transaction[0].timestamp}%`\n        }}/>\n        {transaction.map(request => <div key={\"event-line-\" + request.timestamp} className={\"event-line\"}\n                                         style={{left: `${request.timestamp}%`}}/>)}\n    </div>\n}\n\nexport default function Timeline({session, style}: { session: Session, style?: CSS.Properties }) {\n    const [txnSelected, setTxnSelected] = useState<number | null>(null);\n    const [currentViewingTime, setCurrentViewingTime] = useState(0);\n    const element = useRef(null);\n    const store = (() => {\n        let store = new Store();\n        for (let event of session.events) {\n            if (isAtomic(event)) {\n                if (event.timestamp <= currentViewingTime) {\n                    event.applyOnStore(store)\n                }\n            } else {\n                for (const sub of event.atomics) {\n                    if (sub.timestamp <= currentViewingTime) {\n                        sub.applyOnStore(store)\n                    }\n                }\n            }\n        }\n        return store;\n    })()\n    let handleMouseMove = _.throttle((e) => {\n        let elem = element.current as any as HTMLDivElement;\n        let offset = e.clientX - elem.offsetLeft;\n        setCurrentViewingTime(offset / elem.offsetWidth * 100)\n    }, 100, {'trailing': true});\n\n    return <div className={\"timeline-wrapper\"} style={style}>\n        <div className={\"transaction-bar\"}>\n            {\n                Array.from(session.transactions)\n                    .map(it => <TransactionLine key={it[0].transaction_id}\n                                                transaction={it}\n                                                style={{opacity: it[0].transaction_id === txnSelected ? '100%' : '5%'}}\n                        />\n                    )\n            }\n        </div>\n        <div className={\"timeline\"} ref={element} onMouseMove={handleMouseMove}>\n            <div className={\"rails\"}/>\n            {session.events.map(event => isAtomic(event) ?\n                <AtomicEventView event={event}\n                                 key={\"atomic-ev-\" + event.timestamp}\n                                 onMouseEnter={() => setTxnSelected(event.transaction_id)}\n                                 onMouseLeave={() => setTxnSelected(null)}\n                /> :\n                <GroupEventView events={event}\n                                key={\"group-ev-\" + event.timestamp}\n                                onMouseEnter={() => setTxnSelected(event.transaction_id)}\n                                onMouseLeave={() => setTxnSelected(null)}\n                />\n            )}\n            <div className={\"cursor\"} style={{\n                left: `${currentViewingTime}%`,\n                zIndex: -1\n            }}/>\n        </div>\n        <KeyValueDetail snapshot={store.snapshot(currentViewingTime)}/>\n    </div>\n}","import {AtomicEvent} from \"../atomicEvent\";\nimport {Store} from \"../store\";\n\nexport class StartTxnRequest implements AtomicEvent {\n    readonly typename = \"StartTxnRequest\";\n    constructor(public readonly transaction_id: number) {\n    }\n\n    get timestamp(): number {\n        return this.transaction_id\n    }\n\n    applyOnStore(store: Store): void {\n    }\n\n    get displayFields(): Array<{ name: string; value: string }> {\n        return [\n            {name: \"timestamp\", value: this.timestamp.toString()},\n        ];\n    }\n}","import {AtomicEvent} from \"../../atomicEvent\";\nimport {Store} from \"../../store\";\n\nexport class PrewritePrimary implements AtomicEvent {\n    readonly typename = \"PrewritePrimary\";\n    constructor(\n        public readonly timestamp: number,\n        public readonly transaction_id: number,\n        public readonly key: string,\n        public readonly value: string) {\n    }\n\n    applyOnStore(store: Store): void {\n        store.setData(this.transaction_id, this.key, this.value);\n        store.setLock(this.transaction_id, this.key, {primary: this.key});\n    }\n\n    get displayFields(): Array<{ name: string; value: string }> {\n        return [\n            {name: \"key\", value: this.key},\n            {name: \"value\", value: this.value},\n        ];\n    }\n}","import {AtomicEvent} from \"../../atomicEvent\";\nimport {Store} from \"../../store\";\n\nexport class PrewriteSecondary implements AtomicEvent {\n    readonly typename = \"PrewriteSecondary\";\n    constructor(\n        public readonly timestamp: number,\n        public readonly transaction_id: number,\n        public readonly key: string,\n        public readonly value: string,\n        public readonly primary: string) {\n    }\n\n    applyOnStore(store: Store): void {\n        store.setData(this.transaction_id, this.key, this.value);\n        store.setLock(this.transaction_id, this.key, {primary: this.primary});\n    }\n\n    get displayFields(): Array<{ name: string; value: string }> {\n        return [\n            {name: \"key\", value: this.key},\n            {name: \"value\", value: this.value},\n        ];\n    }\n}","import {AtomicEvent, GroupEvent} from \"../../atomicEvent\";\nimport {Mutation} from \"../../mutation\";\nimport {PrewritePrimary} from \"./prewrite_primary\";\nimport {PrewriteSecondary} from \"./prewrite_secondary\";\nimport * as _ from 'lodash'\nimport {Store} from \"../../store\";\n\nexport class Prewrite implements AtomicEvent, GroupEvent {\n    readonly typename = \"Prewrite\";\n    constructor(\n        public readonly transaction_id: number,\n        public readonly mutations: Array<Mutation>,\n        public readonly primary_lock_on_key: string,\n        public readonly timestamp: number,\n        prewritePrimaryTimestamp?: number,\n        prewriteSecondariesTimestamps?: Array<number>,\n    ) {\n        let maxAllocatedTimestamp = timestamp;\n        if (prewritePrimaryTimestamp !== undefined) {\n            this.prewritePrimary = new PrewritePrimary(\n                prewritePrimaryTimestamp,\n                transaction_id,\n                primary_lock_on_key,\n                mutations.find(it => it.key === primary_lock_on_key)!.value\n            );\n        } else {\n            maxAllocatedTimestamp++;\n            this.prewritePrimary = new PrewritePrimary(\n                maxAllocatedTimestamp,\n                transaction_id,\n                primary_lock_on_key,\n                mutations.find(it => it.key === primary_lock_on_key)!.value\n            );\n        }\n        if (prewriteSecondariesTimestamps !== undefined) {\n            this.prewriteSecondaries = _.zip(mutations, prewriteSecondariesTimestamps).map(\n                ([mutation, prewriteSecondaryTimestamp]) => (\n                    new PrewriteSecondary(\n                        prewriteSecondaryTimestamp!,\n                        transaction_id,\n                        mutation!.key,\n                        mutation!.value,\n                        primary_lock_on_key)\n                )\n            );\n        } else {\n            maxAllocatedTimestamp++;\n            this.prewriteSecondaries = mutations\n                .filter(it => it.key !== primary_lock_on_key)\n                .map((mutation, index) =>\n                    new PrewriteSecondary(maxAllocatedTimestamp + index, transaction_id, mutation.key,\n                        mutation.value, primary_lock_on_key)\n                );\n        }\n    }\n\n    private readonly prewritePrimary: PrewritePrimary;\n    private readonly prewriteSecondaries: Array<PrewriteSecondary>;\n\n    get atomics(): Array<AtomicEvent> {\n        return [this, this.prewritePrimary, ...this.prewriteSecondaries];\n    }\n\n    applyOnStore(store: Store): void {\n    }\n\n    get displayFields(): Array<{ name: string; value: string }> {\n        return [\n            {name: \"primary\", value: this.primary_lock_on_key}\n        ];\n    }\n}","export class Put {\n    constructor(public key: string, public value: string) {\n    }\n}\n\nexport class Del {\n    constructor(public key: string) {\n    }\n\n    get value() {\n        return \"\";\n    }\n}\n\nexport type Mutation = Put | Del;","import {AtomicEvent} from \"../../atomicEvent\";\nimport {Store} from \"../../store\";\n\nexport class CommitPrimary implements AtomicEvent {\n    readonly typename = \"CommitPrimary\";\n    constructor(\n        public readonly transaction_id: number,\n        public readonly commit_at_timestamp: number,\n        public readonly timestamp: number,\n        public readonly key: string) {\n    }\n\n    applyOnStore(store: Store): void {\n        store.setWrite(this.commit_at_timestamp, this.key, {by_transaction: this.transaction_id});\n        store.setLock(this.commit_at_timestamp, this.key, null);\n    }\n\n    get displayFields(): Array<{ name: string; value: string }> {\n        return [\n            {name: \"key\", value: this.key},\n            {name: \"commit_ts\", value: this.commit_at_timestamp.toString()},\n        ];\n    }\n}","import {AtomicEvent} from \"../../atomicEvent\";\nimport {Store} from \"../../store\";\n\nexport class CommitSecondary implements AtomicEvent {\n    readonly typename = \"CommitSecondary\";\n    constructor(\n        public readonly transaction_id: number,\n        public readonly commit_at_timestamp: number,\n        public readonly timestamp: number,\n        public readonly key: string) {\n    }\n\n    applyOnStore(store: Store): void {\n        store.setWrite(this.commit_at_timestamp, this.key, {by_transaction: this.transaction_id});\n        store.setLock(this.commit_at_timestamp, this.key, null);\n    }\n\n    get displayFields(): Array<{ name: string; value: string }> {\n        return [\n            {name: \"key\", value: this.key},\n            {name: \"commit_ts\", value: this.commit_at_timestamp.toString()},\n        ];\n    }\n}","import * as _ from 'lodash'\nimport {AtomicEvent, GroupEvent} from \"../../atomicEvent\";\nimport {CommitPrimary} from \"./commit_primary\";\nimport {CommitSecondary} from \"./commit_secondary\";\nimport {Store} from \"../../store\";\n\nexport class Commit implements AtomicEvent, GroupEvent {\n    readonly typename = \"Commit\";\n    constructor(\n        public readonly transaction_id: number,\n        public readonly keys: Array<string>,\n        public readonly primary_lock_on_key: string,\n        public readonly timestamp: number,\n        commitPrimaryTimestamp?: number,\n        commitSecondariesTimestamps?: Array<number>\n    ) {\n        let maxAllocatedTimestamp = timestamp;\n        if (commitPrimaryTimestamp !== undefined) {\n            this.commitPrimary = new CommitPrimary(transaction_id, timestamp, commitPrimaryTimestamp, primary_lock_on_key);\n        } else {\n            maxAllocatedTimestamp++;\n            this.commitPrimary = new CommitPrimary(transaction_id, timestamp, maxAllocatedTimestamp, primary_lock_on_key);\n        }\n        if (commitSecondariesTimestamps !== undefined) {\n            this.commitSecondaries = _.zip(keys, commitSecondariesTimestamps).map(\n                ([key, prewriteSecondaryTimestamp]) => (\n                    new CommitSecondary(transaction_id, prewriteSecondaryTimestamp!, timestamp, key!)\n                )\n            );\n        } else {\n            maxAllocatedTimestamp++;\n            this.commitSecondaries = keys\n                .filter(it => it !== primary_lock_on_key)\n                .map((key, index) =>\n                    new CommitSecondary(transaction_id, timestamp, maxAllocatedTimestamp + index, key!)\n                );\n        }\n        this.commitSecondaries.sort((a, b) => a.timestamp - b.timestamp);\n    }\n\n    private readonly commitPrimary: CommitPrimary;\n    private readonly commitSecondaries: Array<CommitSecondary>;\n\n    get atomics(): Array<AtomicEvent> {\n        return [this, this.commitPrimary, ...this.commitSecondaries];\n    }\n\n    applyOnStore(store: Store): void {\n    }\n\n    get displayFields(): Array<{ name: string; value: string }> {\n        return [\n            {name: \"primary key\", value: this.primary_lock_on_key}\n        ];\n    }\n}","import {AtomicEvent, GroupEvent} from \"./atomicEvent\";\n\nexport class Session {\n    constructor(public events: Array<AtomicEvent | GroupEvent> = []) {\n    }\n\n    get transactions(): Array<Array<AtomicEvent | GroupEvent>> {\n        let result = new Map();\n        for (const request of this.events) {\n            if (result.has(request.transaction_id)) {\n                result.get(request.transaction_id)!.push(request)\n            } else {\n                result.set(request.transaction_id, [request])\n            }\n        }\n        return Array.from(result.values())\n    }\n}","import React, {FC} from 'react';\nimport './App.css';\nimport Timeline from \"./component/Timeline/Timeline\";\nimport {StartTxnRequest} from \"./model/event/startTxn\";\nimport {Prewrite} from \"./model/event/prewrite/prewrite\";\nimport {Put} from \"./model/mutation\";\nimport {Commit} from \"./model/event/commit/commit\";\nimport {Session} from \"./model/session\";\n\nconst App: FC = () => {\n    let session = new Session();\n    session.events.push(new StartTxnRequest(10));\n    session.events.push(new Prewrite(10, [\n        new Put(\"a\", \"val1\"),\n        new Put(\"b\", \"val2\"),\n    ], \"a\", 15));\n    session.events.push(new Prewrite(21, [\n        new Put(\"c\", \"val3\"),\n        new Put(\"d\", \"val4\"),\n    ], \"c\", 20));\n    session.events.push(new Commit(10, [\"a\", \"b\"], \"a\", 50));\n    // store.push(new GetRequest(21, 60, \"a\"));\n\n    return <div className=\"App\">\n        <Timeline session={session} style={{margin: \"10px\", padding: \"10px\"}}/>\n    </div>\n};\n\nexport default App;","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}